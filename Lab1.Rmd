---
title: "Lab 1"
author: "Namn 1 (liu-id 1) och Namn 2 (liu-id 2)"
date: '20XX-XX-XX'
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(Rlab)
```

## Uppgift 3.1.1

### Simulering av normalfördelning. Simulera 100 och 10000 dragningar från en normalfördelning med μ = 10 och σ = 4.

#### 1) Visualisera fördelningarna i två histogram. Visualisera fördelningens pdf i samma graf.

Nedan simuleras normalfördelningen med olika antalet dragningar, samt ett histogram av dragningarna från normal-fördelningen.

```{r }
x1 <- rnorm(1000, mean = 10, sd = 4)

hist(x1, probability = TRUE)
xfit <- seq(min(x1), max(x1), 1)
yfit <- dnorm(xfit, mean = 10, sd = 4 )
lines(xfit, yfit, col="green")

x2 <- rnorm(100, mean = 10, sd = 4)
hist(x2, probability = TRUE)
xfit <- seq(min(x2), max(x2), 1)
yfit <- dnorm(xfit, mean = 10, sd = 4 )
lines(xfit, yfit, col="green")

```

#### 2) Beskriv skillnaden mellan de olika graferna.

I graf har fler dragningar, vilket gör att den är mer stabil mellan körningar. Den närmar sig mer normalfördelningen.

## Uppgift 3.1.2

## Simulera och visualisera andra fördelningar.

#### 1) Simulera och visualisera följande fördelningar med 10000 dragningar från varje fördelningens täthetsfunktioner

Diskreta fördelningar

```{r }
x1 <- rbern(10000, 0.2)
hist(x1, probability = TRUE, breaks=c(-0.5,0.5,1.5))
xfit <- seq(min(x1), max(x1), 1)
yfit <- dbern(xfit, prob = 0.2)
points(xfit, yfit, col="green")

x2 <- rbinom(20,10000,0.1)
hist(x2, probability = TRUE)
xfit <- seq(min(x2), max(x2), 1)
yfit <- dbinom(xfit, size = 10000, prob = 0.1)
lines(xfit, yfit, col="green")

x3 <- rbinom(20,10000,0.5)
hist(x3, probability = TRUE)
xfit <- seq(min(x3), max(x3), 1)
yfit <- dbinom(xfit, size = 10000, prob = 0.5)
lines(xfit, yfit, col="green")

x4 <- rgeom(10000, 0.1)
hist(x4, probability = TRUE)
xfit <- seq(min(x4), max(x4), 1)
yfit <- dgeom(xfit, prob = 0.1 )
lines(xfit, yfit, col="green")

x5 <- rpois(10000,10)
hist(x5, probability = TRUE)
xfit <- seq(min(x5), max(x5), 1)
yfit <- dpois(xfit, lambda= 10)
lines(xfit, yfit, col="green")
```

Kontinuerliga fördelningar

```{r }
y1 <- runif(10000,0,1)
hist(y1, probability = TRUE)
xfit <- seq(min(y1), max(y1), 0.01)
yfit <- dunif(xfit, min = 0, max = 1 )
points(xfit, yfit, col="green")

y2 <- rexp(10000,3)
hist(y2, probability = TRUE)
xfit <- seq(min(y2), max(y2), 1)
yfit <- dexp(xfit, rate = 3)
lines(xfit, yfit, col="green")

y3 <- rgamma(10000,2,1)
hist(y3, probability = TRUE)
xfit <- seq(min(y3), max(y3), 1)
yfit <- dgamma(xfit, shape = 2, rate = 1 )
lines(xfit, yfit, col="green")

y4 <- rt(10000,3)
hist(y4, probability = TRUE)
xfit <- seq(min(y4), max(y4), 1)
yfit <- dt(xfit, df = 3)
lines(xfit, yfit, col="green")

y5 <- rbeta(10000,shape1=0.1,shape2=0.1)
hist(y5, probability = TRUE)
xfit <- seq(min(y5), max(y5), 0.01)
yfit <- dbeta(xfit,shape1=0.1,shape2=0.1)
lines(xfit, yfit, col="green")

y6 <- rbeta(10000,1,1)
hist(y6, probability = TRUE)
xfit <- seq(min(y6), max(y6), 0.01)
yfit <- dbeta(xfit,shape1 = 1,shape2 =1)
lines(xfit, yfit, col="green")

y7 <- rbeta(10000,10,5)
hist(y7, probability = TRUE)
xfit <- seq(min(y7), max(y7), 0.01)
yfit <- dbeta(xfit,shape1 = 10,shape2 =5)
lines(xfit, yfit, col="green")

```

## Uppgift 3.1.3

## Relation mellan fördelningar. Nedan finns två stycken sannolikhetsfördelningar som konvergerar mot andra sannolikhetsfördelningar.

X ∼ Binomial(n = 10000, p = 0.001)

Y ∼ Student-t(ν = 10000)

#### (1) Simulera 1000 värden från respektive fördelning och visualisera fördelningen i ett histogram tillsammans med fördelningens täthetsfunktionen.

```{r }
x1 <- rbinom(n= 10000, size = 1000 ,prob = 0.001 )
hist(x1, probability = TRUE)
xfit <- seq(min(x1), max(x1))
yfit <- dbinom(xfit, size= 1000, prob = 0.001)
lines(xfit, yfit, col="green")

x2 <- rt(n=10000, df=1000)
hist(x2, probability = TRUE)
xfit <- seq(min(x2), max(x2), 1)
yfit <- dt(xfit, df = 1000)
lines(xfit, yfit, col="green")

```

#### (2) Ta reda på (t ex via Wikipedia eller föreläsningarnas slides) vilken annan fördelning som respektive fördelning börjar konvergera mot.

Binomial fördelning konvergerar mot Poisson fördelning Student t fördelningen kovergerar mot Standard Normal fördelning

#### (3) Simulera dragningar från dessa fördelning och jämför resultatet med de resultat du fick i (1).

```{r }
x1 <- rpois(10000, 1)
hist(x1, probability = TRUE)
xfit <- seq(min(x1), max(x1))
yfit <- dpois(xfit, 1)
lines(xfit, yfit, col="green")

x2 <- rnorm(10000, 1)
hist(x2, probability = TRUE)
xfit <- seq(min(x2), max(x2))
yfit <- dnorm(xfit, 1)
lines(xfit, yfit, col="green")


```

Vi simulerade, och det är tydligt att de är väldigt lika.

## Uppgift 3.1.4

## Analytisk sannolikhet och approximation med Monte Carlo metoder. Varje fördelning i R har också en funktion för att beräkna sannolikheten direkt. På samma sätt som funktioner simulerar värden med prefixet r har vi den kumulativa fördelningsfunktionen med prefixet p och täthetfunktionen med prefixet d. I denna uppgift ska vi arbeta med två fördelningar X ∼ N (μ = 0, σ = 1) Y ∼ Bin(n = 10, p = 0.1)

#### 1) Använd täthetsfunktionen i R för att beräkna PPP (Y = 0). Simulera nu 10000 dragningar från Y och beräkna andelen dragningar där y = 0

```{r }
x <- dbinom(0, size=10, prob = 0.1)
y <- rbinom(10000, size = 10, prob = 0.1)
print(paste("P(Y=0)", x))
print(paste("Simulated 10000 times", mean(y==0)))

```



#### 2) Använd nu den kumulativa fördelningsfunktionen i R för att beräkna följande sanno-likheter. ● PPP (X \< 0) ● PPP (−1 \< X \< 1) ● PPP (1.96 \< X) ● PPP (0 \< Y \< 10) ● PPP (Y = 0) ● PPP (0 ≤ Y ≤ 10)

```{r }
#P(X<0)
a <- pnorm(0, mean = 0, sd = 1)
print(a)

#P(X<0)
b <- pnorm(1, mean = 0, sd = 1)-(pnorm(-1, mean = 0, sd = 1))
print(b)

#P(1.096<X)
c <- 1-pnorm(1.96, mean = 0, sd = 1)
print(c)

#P(X<0)
d <- pbinom(10, 10, 0.1) - pbinom(0, 10,  0.1)
print(d)

#P(X=0)
e <- pbinom(-0.0001,10, 0.1) + pbinom(0.0001, 10,  0.1)
print(e)

#P(1.096<X)
f <- e + d
print(f)



```

#### 3) Beräkna samma sannolikheter som i (2) men genom att simulera dragningar från X och Y i R.
```{r }
#P(X<0)
a <- rnorm(10000, 0,1)
print(a)

#P(X<0)
b <- rbinom(10000, size = 10, prob = 0.1)
print(b)

print(mean(a<0))
print(mean(-1<a<0))
print(mean(1.96<a))
print(mean(0<b<10))
print(mean(b=0))
print(mean(0<=b<=10))


```